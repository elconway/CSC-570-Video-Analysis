<html>
  <head>
    <script src="webgazer.js" type="text/javascript"></script>
  </head>
    <script>
      var writeData = ["Timestamp,X,Y\n"];
      var videoLink = "";
      webgazer.resume();
      webgazer.setGazeListener(function(data, elapsedTime) {
        if (data != null) {
          var x = data.x;
          var y = data.y;
          document.getElementById("gazeData").innerHTML = "Gaze coordinates: x=" + x + ", y=" + y;
          writeData.push(Date.now() + "," + x + "," + y + "\n");
        }
      }).begin();
      
      function createVideo() {
        var id = document.getElementById("vidLink").value;
        console.log(id);
        var vid = document.getElementById("videoView");
        if (id.includes("http")) {
          vid.src = id.substring(0, 24) + "embed/" + id.substring(32);
        } else {
          vid.src = "https://www.youtube.com/embed/" + id;
        }
      }
      
      function createDownload() {
        var filename = "data.csv";
        var blob = new Blob(writeData, {type:'text/plain'});
        var link = document.getElementById("link");
        link.download = filename;
        link.innerHTML = "Download File";
        link.href = window.URL.createObjectURL(blob);
      }

    </script>
  <body>
    <div style="text-align: right;" id="gazeData"></div>
    <div style="text-align: right;" id="linkInput">
      <input type="text" id="vidLink"></input>
      <button onclick="createVideo()">Submit</button>
    </div>
    <style>
          html, body {height: 100%;margin: 0; padding: 0; }
          table, iframe {width: 100%;height: 100%;border-collapse: collapse;}
          td {border: 1px solid black;}
    </style>
    <table>
      <tr>
        <td id="Cell 1">Cell 1</td>
        <td id="Cell 2">Cell 2</td>
        <td id="Cell 3">Cell 3</td>
      </tr>
      <tr>
        <td id="Cell 4">Cell 4</td>
        <td id="Cell 5">Cell 5</td>
        <td id="Cell 6">Cell 6</td>
      </tr>
      <tr>
        <td id="Cell 7">Cell 7</td>
        <td id="Cell 8"><a id="link">Cell 8</a></td>
        <td id="Cell 9"><button onclick="createDownload()">Create Download</button></td>
      </tr>
    </table>
    <iframe id="videoView" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
  </body>
</html>